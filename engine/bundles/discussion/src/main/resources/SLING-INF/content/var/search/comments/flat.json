{
  "sakai:query-language": "xpath",
  "sakai:query-template" : "/{path}//element(*)MetaData[@sling:resourceType='sakai/message' and @sakai:type='comment' and @sakai:marker='{marker}'] order by @{sortOn|sakai:created} {sortOrder|ascending}",
  "sling:resourceType": "sakai/search",
  "sakai:resultprocessor": "Comment",
  "sakai:title": "Comments",
  "sakai:shortDescription": "Find all comments identified by a unique marker stored under a certain path.",
  "sakai:parameters" : [
      "{\"name\" : \"path\", \"description\" : \"The path to look under. It's recommended to use a messagestore\"}",
      "{\"name\" : \"marker\", \"description\" : \"The uniquer marker that identifies a conversation.\"}",
      "{\"name\" : \"sortOn\", \"description\" : \"The name of the property you wish to sort on. This only has any affect if it is used with the sortOrder parameter. Default is sakai:created\"}",
      "{\"name\" : \"sortOrder\", \"description\" : \"The order you wish to sort in. Either 'ascending' or 'descending'.\"}"      
      ],
  "sakai:description": "This will look for comments part of a conversation under a certain path.",
  "sakai:response": "Doing a query for comments identified by id430889819 on the my-course-site.<br /> Example: /var/search/comments/flat.json?marker=id430889819&path=/sites/my-course-site<br /><pre class=\"json\">{\n    \"query\": \"//sites/my-course-site/store//element(*)MetaData[@sling:resourceType='sakai/message' and @sakai:type='comment' and @sakai:marker='id430889819'] order by @sakai:created ascending\",\n    \"items\": 10,\n    \"total\": 2,\n    \"results\": [\n        {\n            \"post\": {\n                \"sakai:sendstate\": \"notified\",\n                \"sakai:from\": \"simong\",\n                \"sakai:id\": \"cbb21679f40a09e109d181f93e77e8d203559c23\",\n                \"sakai:body\": \"This is the first comment\",\n                \"sakai:subject\": \"Comment on sites/my-course-site/_widgets\",\n                \"sling:resourceType\": \"sakai/message\",\n                \"sakai:messagebox\": \"inbox\",\n                \"sakai:to\": \"s-my-course-site\",\n                \"sakai:read\": \"false\",\n                \"sakai:marker\": \"id430889819\",\n                \"jcr:primaryType\": \"nt:unstructured\",\n                \"sakai:type\": \"comment\",\n                \"sakai:created\": \"2009-12-22 03:20:25+0000\",\n                \"sakai:id\": \"cbb21679f40a09e109d181f93e77e8d203559c23\",\n                \"canEdit\": true,\n                \"canDelete\": true,\n                \"profile\": {\n                    \"picture\": \"{\"name\":\"256x256_profilepicture\",\"_name\":\"profilepicture\"}\",\n                    \"email\": [\n                        \"gaeremyncks@gmail.com\"\n                    ],\n                    \"firstName\": [\n                        \"Simon\"\n                    ],\n                    \"sling:resourceType\": \"sakai/user-profile\",\n                    \"jcr:created\": \"2009-11-30T16:23:18\",\n                    \"rep:userId\": [\n                        \"simong\"\n                    ],\n                    \"lastName\": [\n                        \"Gaeremynck\"\n                    ],\n                    \"jcr:primaryType\": \"sling:Folder\",\n                    \"jcr:uuid\": [\n                        \"1295479e-c673-46cc-a63c-52c6d19f4b44\"\n                    ]\n                }\n            },\n            \"replies\": [\n                \n            ]\n        },\n        {\n            \"post\": {\n                \"sakai:sendstate\": \"notified\",\n                \"sakai:from\": \"simong\",\n                \"sakai:id\": \"67b92512323e0ef082993cdac7f6e9e0a16ac4d5\",\n                \"sakai:body\": \"This is the second comment\",\n                \"sakai:subject\": \"Comment on sites/my-course-site/_widgets\",\n                \"sling:resourceType\": \"sakai/message\",\n                \"sakai:messagebox\": \"inbox\",\n                \"sakai:to\": \"s-my-course-site\",\n                \"sakai:read\": \"false\",\n                \"sakai:marker\": \"id430889819\",\n                \"jcr:primaryType\": \"nt:unstructured\",\n                \"sakai:type\": \"comment\",\n                \"sakai:created\": \"2009-12-22 03:20:47+0000\",\n                \"sakai:id\": \"67b92512323e0ef082993cdac7f6e9e0a16ac4d5\",\n                \"canEdit\": true,\n                \"canDelete\": true,\n                \"profile\": {\n                    \"picture\": \"{\"name\":\"256x256_profilepicture\",\"_name\":\"profilepicture\"}\",\n                    \"email\": [\n                        \"gaeremyncks@gmail.com\"\n                    ],\n                    \"firstName\": [\n                        \"Simon\"\n                    ],\n                    \"sling:resourceType\": \"sakai/user-profile\",\n                    \"jcr:created\": \"2009-11-30T16:23:18\",\n                    \"rep:userId\": [\n                        \"simong\"\n                    ],\n                    \"lastName\": [\n                        \"Gaeremynck\"\n                    ],\n                    \"jcr:primaryType\": \"sling:Folder\",\n                    \"jcr:uuid\": [\n                        \"1295479e-c673-46cc-a63c-52c6d19f4b44\"\n                    ]\n                }\n            },\n            \"replies\": [\n                \n            ]\n        }\n    ]\n}</pre>"
}